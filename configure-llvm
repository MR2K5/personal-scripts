#!/bin/bash

cd ${0%/*}
cmake ../llvm -G "Ninja" -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native -DLLVM_ENABLE_PROJECTS="llvm;clang;clang-tools-extra;lld;lldb" \
-DLLVM_ENABLE_RUNTIMES="libcxx;libcxxabi;libunwind;compiler-rt" -DLLVM_CCACHE_BUILD=TRUE -DLLVM_ENABLE_LLD=TRUE -DLLVM_PARALLEL_LINK_JOBS=1 -DLLVM_TARGETS_TO_BUILD="X86" -DLLVM_ENABLE_LIBCXX=TRUE \
-DCLANG_DEFAULT_LINKER=lld -DCLANG_DEFAULT_CXX_STDLIB=libc++ -DCLANG_DEFAULT_RTLIB=compiler-rt -DCLANG_DEFAULT_UNWINDLIB=libunwind \
-DLLDB_ENABLE_PYTHON=TRUE -DCOMPILER_RT_CXX_LIBRARY=libcxx -DCOMPILER_RT_USE_LLVM_UNWINDER=TRUE -DCOMPILER_RT_USE_BUILTINS_LIBRARY=TRUE \
-DLIBUNWIND_USE_COMPILER_RT=TRUE -DCOMPILER_RT_USE_LLVM_UNWINDER=TRUE -DCOMPILER_RT_USE_BUILTINS_LIBRARY=TRUE -DCOMPILER_RT_CXX_LIBRARY=libcxx \
-DLIBCXXABI_USE_LLVM_UNWINDER=TRUE -DLIBCXXABI_USE_COMPILER_RT=TRUE  -DLIBCXX_USE_COMPILER_RT=TRUE -DLIBCXX_CXX_ABI=libcxxabi -DLIBCXXABI_ADDITIONAL_COMPILE_FLAGS="-march=native" \
-DLIBCXX_ADDITIONAL_COMPILE_FLAGS="-march=native"
